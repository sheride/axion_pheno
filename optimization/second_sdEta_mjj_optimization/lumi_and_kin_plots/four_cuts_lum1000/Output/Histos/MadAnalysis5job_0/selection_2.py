def selection_2():

    # Library import
    import numpy
    import matplotlib
    import matplotlib.pyplot   as plt
    import matplotlib.gridspec as gridspec

    # Library version
    matplotlib_version = matplotlib.__version__
    numpy_version      = numpy.__version__

    # Histo binning
    xBinning = numpy.linspace(-3.2,3.2,65,endpoint=True)

    # Creating data sequence: middle of each bin
    xData = numpy.array([-3.15,-3.05,-2.95,-2.85,-2.75,-2.65,-2.55,-2.45,-2.35,-2.25,-2.15,-2.05,-1.95,-1.85,-1.75,-1.65,-1.55,-1.45,-1.35,-1.25,-1.15,-1.05,-0.95,-0.85,-0.75,-0.65,-0.55,-0.45,-0.35,-0.25,-0.15,-0.05,0.05,0.15,0.25,0.35,0.45,0.55,0.65,0.75,0.85,0.95,1.05,1.15,1.25,1.35,1.45,1.55,1.65,1.75,1.85,1.95,2.05,2.15,2.25,2.35,2.45,2.55,2.65,2.75,2.85,2.95,3.05,3.15])

    # Creating weights for histo: y3_PHI_0
    y3_PHI_0_weights = numpy.array([124.46019302,301.222241083,307.363335805,316.882127623,307.465735717,303.883338796,307.670435541,303.985738708,303.985738708,304.190438532,293.034048122,304.395138356,305.828037125,299.072842931,306.749236333,304.497538268,303.678638972,304.804538004,297.639944163,298.151643723,299.584642491,305.521037388,308.182135101,310.945632726,302.450440028,314.528029646,318.519726215,299.789342315,294.569346802,289.861150849,300.403441787,314.425629734,304.08803862,305.521037388,314.425629734,310.229233341,306.339836685,315.346828943,302.450440028,307.363335805,309.103334309,307.158635981,308.079835189,308.489234837,314.73272947,299.994042139,295.695245834,296.206945394,303.678638972,293.750547506,310.12683343,309.001034397,304.804538004,312.17393167,312.17393167,301.836340556,303.781038884,309.922133605,308.386834925,305.828037125,307.670435541,294.262247066,306.646936421,127.837790117])

    # Creating weights for histo: y3_PHI_1
    y3_PHI_1_weights = numpy.array([0.0,0.0,0.303102055981,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.304262344601,0.0,0.0,0.304383383345,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.303284616073,0.0,0.0,0.0,0.0,0.0])

    # Creating weights for histo: y3_PHI_2
    y3_PHI_2_weights = numpy.array([0.251331227181,0.752379398161,0.251331227181,0.0,0.0,1.00518101055,0.25046763154,0.753870340253,0.5017286141,0.753942237689,0.754050083843,0.250774331954,0.501531206053,0.0,0.501497839858,0.0,1.00382683887,0.502448931374,0.752295414517,0.752847041398,0.501675310828,0.251741745014,0.251507251939,0.250811107079,1.00597188235,0.502506263381,0.25046763154,1.2542931275,0.250822986684,0.752175688758,0.502516076968,0.0,0.251143322819,0.752628559965,0.0,0.250852324144,0.501841315397,0.75265624461,0.502564834999,0.25046763154,0.250852324144,0.501829332491,1.50603642203,0.501870549556,0.752456977147,0.502490664943,1.00383892508,0.0,0.250852324144,0.0,0.0,0.250384061101,0.502177456571,0.501139385686,0.502161548231,0.250748919929,0.50210039409,0.250774331954,0.250852324144,0.0,0.752492822564,0.754256685672,0.50197157785,0.250811107079])

    # Creating weights for histo: y3_PHI_3
    y3_PHI_3_weights = numpy.array([1.51141180916,3.02612750931,2.61277956514,2.47599360272,2.06313215219,3.30113453959,2.47389325025,2.20097946293,2.61301113205,2.47191782203,2.88730619566,2.61406435522,1.65136048802,2.33783144224,2.3394666296,2.06232979317,3.57582468884,2.61239768288,2.20086571077,1.51161290673,2.4748703001,2.8876301862,2.61090062314,2.4766598654,2.47534054342,2.20083117886,2.74926997507,1.78766808196,1.92546867307,3.43884473835,1.92409755322,2.20031218461,2.20050414139,1.78834856366,2.06288331933,3.30211057379,1.64885489346,2.61160852723,3.02534444754,2.74942029043,2.888381763,2.06352622219,2.47471998474,2.88625500378,2.61170704473,2.75097219496,1.65018640317,2.19970889188,2.61308425844,1.65056523851,2.61178524935,1.51053937068,2.20049195365,2.74710665265,2.33784870819,2.47669541295,1.65123962634,3.57563984157,1.09939131213,2.75133173305,2.06219471247,2.06270253464,1.92531124819,1.23665767431])

    # Creating weights for histo: y3_PHI_4
    y3_PHI_4_weights = numpy.array([0.81419876202,1.72675693117,1.52965231908,1.65294528879,1.35703835362,1.65297835717,1.92480449328,1.28270062328,2.14654204626,2.09690940603,1.67691385575,1.75191896623,1.65302244835,2.19529386496,1.5791085946,2.17082325978,1.67786081406,1.55430930971,1.60372850855,1.72689421507,1.6776423623,1.82600116813,1.80086117866,1.82542497656,1.48022610573,1.67758223797,1.89993005297,1.99854899682,1.85043770285,1.87528408514,1.70228833013,1.52971745378,1.5296082279,1.47999562911,1.72707158187,1.80073992792,1.92479948292,1.82501412693,1.52896990785,1.75151412902,1.77631241184,1.62846466288,1.92444875762,1.75106119235,1.65312967009,2.26996227915,2.12216262966,1.97425074807,2.2448974451,1.65327497057,1.89910634955,2.0226257876,1.94928612126,1.43113358246,1.949573716,1.62802174693,1.6774399437,1.85010802107,1.60402812816,1.52971845585,1.57920880182,2.0477427294,1.62823919662,0.64163960991])

    # Creating weights for histo: y3_PHI_5
    y3_PHI_5_weights = numpy.array([0.252083219827,0.573526398008,0.604899299412,0.642825439271,0.642939871374,0.712165091928,0.636494863281,0.787785606627,0.542013557346,0.680600636785,0.529546059694,0.680724671582,0.598626739698,0.623996356931,0.611185662998,0.749589491028,0.667920879586,0.737398570968,0.756311876937,0.831768045531,0.70598665862,0.718466759808,0.573398362089,0.674191138654,0.655409969755,0.724752723282,0.592332974035,0.686886500231,0.604964117596,0.649143511753,0.743463172341,0.687043644317,0.579761247142,0.535592756044,0.611262884662,0.617500234498,0.598593430353,0.604974820598,0.567205324684,0.636520570493,0.686935513982,0.756170137173,0.649015075722,0.567329159425,0.655456882917,0.598586628445,0.68685459128,0.668038112475,0.6491034005,0.712049059376,0.674502225927,0.611297494371,0.749904679452,0.586142237276,0.718458557507,0.630324932359,0.686949817995,0.705691875921,0.59226665543,0.611238177731,0.605081750597,0.674233850637,0.630178891389,0.258365782348])

    # Creating weights for histo: y3_PHI_6
    y3_PHI_6_weights = numpy.array([0.086003860735,0.236265875349,0.236132788864,0.286267155125,0.24328701845,0.164717431259,0.221951692831,0.286241412575,0.264765127749,0.279138218218,0.235905354682,0.207845375158,0.207680023011,0.186073800788,0.236052412124,0.207791015889,0.264862349613,0.214676073374,0.26511277714,0.250721691878,0.286326387983,0.200529367389,0.279116224583,0.300649242991,0.243287218393,0.222009426123,0.264598425992,0.264868097949,0.186086272179,0.300614253117,0.243577709325,0.214561981392,0.229270524783,0.250603726017,0.157176763506,0.264496205574,0.228944419157,0.250827661211,0.271845328759,0.236222587876,0.2217918141,0.286072461469,0.25037904104,0.24329749042,0.236120417444,0.30036057653,0.322274234782,0.207334572983,0.243628944498,0.257405757529,0.293453825324,0.200453539334,0.264844604748,0.336334665734,0.279236939649,0.272243963396,0.221782616761,0.322486423375,0.293535051817,0.286216919663,0.193420649631,0.186149828786,0.221888136224,0.157212903047])

    # Creating weights for histo: y3_PHI_7
    y3_PHI_7_weights = numpy.array([0.00755978783381,0.0253844666254,0.0188956636737,0.0210679088955,0.0183590747741,0.0172762892109,0.0183614636183,0.0156620486678,0.0253797832334,0.0161927387985,0.0264202191981,0.0205148704983,0.0210604175638,0.0199746773775,0.0145785087328,0.0221260202122,0.0248388776503,0.0156677588437,0.0323253373955,0.0199923317747,0.0259227214295,0.0167380972711,0.0220955205386,0.0162097331203,0.0183148811556,0.0204801170055,0.0189017405582,0.0221388026244,0.0264670007312,0.0183554391208,0.0216045292273,0.0242989883738,0.0350967319949,0.0205125445183,0.0248422828011,0.0259178284898,0.0194411688297,0.0183574403017,0.0258366601724,0.02429864262,0.029702344506,0.0226376624533,0.0248391186302,0.0199854690862,0.0221418829762,0.0270006350077,0.0237660875144,0.0183537103519,0.0172802077537,0.0199736925031,0.0178233240654,0.0248502246604,0.0243032317155,0.0243023830472,0.0216079029459,0.0199800837092,0.022674280921,0.0216008307097,0.0269543982987,0.0199448063471,0.0275409224249,0.0205226237647,0.0205221103727,0.00647807725057])

    # Creating weights for histo: y3_PHI_8
    y3_PHI_8_weights = numpy.array([0.00142115777904,0.000709935021082,0.00141994391349,0.0,0.0,0.00213037004898,0.00283991344066,0.000709935021082,0.00142142505219,0.00354974934795,0.00284010684248,0.000709212269942,0.00425430920904,0.00283147540463,0.00354690697225,0.00284080435116,0.00071073164355,0.000709212269942,0.00213014620772,0.00212822518197,0.00354642179725,0.00283935847766,0.00212789665872,0.0014204350279,0.0,0.0042601743698,0.00284034850195,0.00141894906344,0.0014214632871,0.00496473237483,0.000709212269942,0.00354694075261,0.00142066703584,0.00212835956097,0.00354849687628,0.00212449746397,0.00426048247635,0.00496241229541,0.00355017958348,0.00213268604506,0.0,0.00283071701707,0.00280619730416,0.00354512960582,0.00212908231211,0.00283881947681,0.000711222757961,0.00141868179029,0.0028356637976,0.00213317715947,0.00420660837624,0.0,0.000708746769208,0.00354760967791,0.00141894906344,0.000709212269942,0.002841898315,0.000709935021082,0.00493309762797,0.00281017596195,0.00284057234321,0.00496559730044,0.00280020630228,0.00142115777904])

    # Creating weights for histo: y3_PHI_9
    y3_PHI_9_weights = numpy.array([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])

    # Creating weights for histo: y3_PHI_10
    y3_PHI_10_weights = numpy.array([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,26.32395418,26.365709718,0.0,0.0,0.0,0.0,0.0,0.0,26.3028457174,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])

    # Creating weights for histo: y3_PHI_11
    y3_PHI_11_weights = numpy.array([0.0,0.0,17.2762385664,0.0,17.2684090664,5.74956309789,5.75465659595,5.75900461033,5.76422779951,17.2966048733,5.76163301673,5.75900461033,11.5193080531,17.280686491,11.5027748389,5.75050455924,11.5252546304,11.5254179451,17.2587446773,0.0,0.0,11.535889301,5.76613089639,0.0,0.0,5.76549204761,0.0,0.0,5.74956309789,5.75050455924,23.0426125135,5.76549204761,11.5154365334,11.5085677082,17.2623568148,0.0,5.76613089639,5.75900461033,0.0,0.0,5.76422779951,22.9876907322,28.7863721746,0.0,5.75911893064,5.75465659595,5.76378204637,0.0,5.76070692617,23.0502306651,11.5329592427,0.0,5.74956309789,0.0,17.272626429,0.0,5.75285340925,5.75465659595,5.76070692617,0.0,0.0,0.0,34.5566368549,0.0])

    # Creating weights for histo: y3_PHI_12
    y3_PHI_12_weights = numpy.array([2.07793629278,8.31166535096,8.3036958362,6.92473032189,3.46298256513,5.53744812317,7.61565753556,6.2306468457,3.46251710777,5.54199402594,3.46082549724,6.23292700975,3.45713742084,5.54371929558,4.15636112345,2.76920586765,4.15530518919,3.45667581023,5.53902529274,5.53319649716,3.45896655286,2.07668802077,4.15726030245,5.53505159478,7.61501512747,6.92337818749,4.8494386732,4.84565827468,4.1583768231,7.6171346895,2.77135235697,6.91964587341,4.84430229353,4.14898689404,4.15640536114,4.14872339131,5.5448473565,8.30705982348,2.76969632892,2.07591482301,6.92225974346,2.76969344386,1.38320656175,6.23035256894,4.1524557054,6.23050355407,6.23117865958,5.53686726316,2.76909719683,5.53912338499,1.38580023633,4.84818174599,4.84051708656,6.92288580284,6.92045273028,2.07731600353,1.38723988441,6.23039969169,7.61705390764,4.15400306261,3.4567642856,5.53578055486,2.76483980068,2.07472232894])

    # Creating weights for histo: y3_PHI_13
    y3_PHI_13_weights = numpy.array([1.00795497256,1.51145635669,1.76196331156,2.27029717798,1.51017582702,1.51089513877,0.755704889091,1.51274219662,2.77390947055,0.756868441467,1.76429678861,2.01620155389,0.756293113444,2.01617576123,1.76387045113,1.7628432964,1.00920561309,1.76505236181,1.00949585637,1.26071271625,0.757322999156,0.75650461325,2.26826410955,1.26077689445,0.756497634059,1.0080687637,1.00762604029,2.51949219682,1.26078797012,1.51053631736,1.76238964904,1.26005682409,1.51262385383,0.756755712374,1.01006966717,1.51432950721,1.76144594115,2.01531398296,1.00817436188,2.01739105064,1.00918573757,2.52142816348,0.505002213459,1.76292977767,2.01494681687,2.018063177,0.503512914969,1.76511760206,0.756640707458,1.5130790184,1.26059027698,1.51265556362,1.51271959011,1.76467457521,0.755392342749,0.756159901945,1.25981042834,1.26147481347,2.26786204751,0.756131530019,0.755688958331,1.26082802461,1.51132800028,0.755885741149])

    # Creating weights for histo: y3_PHI_14
    y3_PHI_14_weights = numpy.array([0.353410043649,0.707276009532,0.424559305338,0.424714357373,0.494956487714,0.636770617766,0.636609698378,0.707334490696,0.212399452488,0.495410774784,0.565352612042,0.565564317704,0.777915003826,0.495666052761,0.212186592593,0.282969673703,0.636105009778,0.777830840967,0.636767443623,0.141182187208,0.777761202212,0.636748110212,0.636545734604,0.56629821784,0.424007293165,0.56616490387,0.848383941051,0.778043604676,0.565437448204,0.848740791576,0.283319887386,0.706956863968,0.49548262582,0.990413143279,0.565916647481,0.424696851498,0.424032686302,0.283193883561,0.636575648489,0.849269238149,1.06054437102,0.566047460611,1.27242124429,0.565794875846,0.849009920355,0.565885290804,0.283046814976,0.424676748598,0.495061138218,0.49512539055,0.424500343244,0.70707199876,0.565714079501,0.424119927118,0.424446190455,0.495388940533,0.495111635934,0.494920033172,0.565818922377,0.707401436239,0.494992461325,0.56510291286,0.920019519791,0.424033648163])

    # Creating weights for histo: y3_PHI_15
    y3_PHI_15_weights = numpy.array([0.0,0.0761340321183,0.114635940825,0.0,0.038407386739,0.114161587694,0.0756785301954,0.115093688346,0.0,0.0758913301986,0.0381239981205,0.0764151751383,0.0,0.11491123347,0.0,0.0,0.0377124035574,0.0,0.038407386739,0.0377789146386,0.0380237439674,0.0380237439674,0.0757531372501,0.0380407336928,0.0,0.0,0.0,0.0,0.0380237439674,0.0,0.0381239981205,0.0754248071148,0.0760719531393,0.0760829152056,0.0756828736557,0.0,0.0,0.0,0.076117131035,0.0380237439674,0.0763571441461,0.0383334001786,0.0379318517139,0.0379318517139,0.0,0.0,0.0,0.113880858337,0.113966102437,0.0380651693499,0.0,0.0383334001786,0.076716558092,0.0764321648636,0.0,0.0,0.0763290150704,0.03811241556,0.0763043134871,0.037816351129,0.0381611095901,0.0384553716328,0.0377124035574,0.0])

    # Creating weights for histo: y3_PHI_16
    y3_PHI_16_weights = numpy.array([0.0,0.00901267482515,0.00901644959656,0.0090233966389,0.0,0.00902227055971,0.0,0.0,0.00451565355227,0.0,0.0,0.00451917423401,0.0,0.00450386436945,0.00901343613167,0.0,0.0,0.00451565355227,0.0,0.00452425602724,0.0,0.00452921077564,0.0,0.0,0.00451531957835,0.00451835806722,0.00901540917639,0.00903437735461,0.0,0.00451715114133,0.013554364868,0.00902892693888,0.00450507514519,0.00452425602724,0.00451917423401,0.0045000905605,0.00902901259789,0.00901926479452,0.00903489419608,0.00451887587115,0.0,0.00451382583913,0.00451565355227,0.0,0.00451382583913,0.0,0.0,0.0,0.0,0.00451601928738,0.0,0.00450507514519,0.0,0.0,0.0,0.00451565355227,0.00451642833324,0.013567146348,0.00451642833324,0.0,0.00449996736551,0.00903430709497,0.0,0.00451258426465])

    # Creating a new Canvas
    fig   = plt.figure(figsize=(12,6),dpi=80)
    frame = gridspec.GridSpec(1,1,right=0.7)
    pad   = fig.add_subplot(frame[0])

    # Creating a new Stack
    pad.hist(x=xData, bins=xBinning, weights=y3_PHI_0_weights+y3_PHI_1_weights+y3_PHI_2_weights+y3_PHI_3_weights+y3_PHI_4_weights+y3_PHI_5_weights+y3_PHI_6_weights+y3_PHI_7_weights+y3_PHI_8_weights+y3_PHI_9_weights+y3_PHI_10_weights+y3_PHI_11_weights+y3_PHI_12_weights+y3_PHI_13_weights+y3_PHI_14_weights+y3_PHI_15_weights+y3_PHI_16_weights,\
             label="$bg\_dip\_1600\_inf$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#e5e5e5", linewidth=1, linestyle="solid",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y3_PHI_0_weights+y3_PHI_1_weights+y3_PHI_2_weights+y3_PHI_3_weights+y3_PHI_4_weights+y3_PHI_5_weights+y3_PHI_6_weights+y3_PHI_7_weights+y3_PHI_8_weights+y3_PHI_9_weights+y3_PHI_10_weights+y3_PHI_11_weights+y3_PHI_12_weights+y3_PHI_13_weights+y3_PHI_14_weights+y3_PHI_15_weights,\
             label="$bg\_dip\_1200\_1600$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#f2f2f2", linewidth=1, linestyle="solid",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y3_PHI_0_weights+y3_PHI_1_weights+y3_PHI_2_weights+y3_PHI_3_weights+y3_PHI_4_weights+y3_PHI_5_weights+y3_PHI_6_weights+y3_PHI_7_weights+y3_PHI_8_weights+y3_PHI_9_weights+y3_PHI_10_weights+y3_PHI_11_weights+y3_PHI_12_weights+y3_PHI_13_weights+y3_PHI_14_weights,\
             label="$bg\_dip\_800\_1200$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#ccc6aa", linewidth=1, linestyle="solid",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y3_PHI_0_weights+y3_PHI_1_weights+y3_PHI_2_weights+y3_PHI_3_weights+y3_PHI_4_weights+y3_PHI_5_weights+y3_PHI_6_weights+y3_PHI_7_weights+y3_PHI_8_weights+y3_PHI_9_weights+y3_PHI_10_weights+y3_PHI_11_weights+y3_PHI_12_weights+y3_PHI_13_weights,\
             label="$bg\_dip\_600\_800$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#ccc6aa", linewidth=1, linestyle="solid",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y3_PHI_0_weights+y3_PHI_1_weights+y3_PHI_2_weights+y3_PHI_3_weights+y3_PHI_4_weights+y3_PHI_5_weights+y3_PHI_6_weights+y3_PHI_7_weights+y3_PHI_8_weights+y3_PHI_9_weights+y3_PHI_10_weights+y3_PHI_11_weights+y3_PHI_12_weights,\
             label="$bg\_dip\_400\_600$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#c1bfa8", linewidth=1, linestyle="solid",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y3_PHI_0_weights+y3_PHI_1_weights+y3_PHI_2_weights+y3_PHI_3_weights+y3_PHI_4_weights+y3_PHI_5_weights+y3_PHI_6_weights+y3_PHI_7_weights+y3_PHI_8_weights+y3_PHI_9_weights+y3_PHI_10_weights+y3_PHI_11_weights,\
             label="$bg\_dip\_200\_400$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#bab5a3", linewidth=1, linestyle="solid",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y3_PHI_0_weights+y3_PHI_1_weights+y3_PHI_2_weights+y3_PHI_3_weights+y3_PHI_4_weights+y3_PHI_5_weights+y3_PHI_6_weights+y3_PHI_7_weights+y3_PHI_8_weights+y3_PHI_9_weights+y3_PHI_10_weights,\
             label="$bg\_dip\_100\_200$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#b2a596", linewidth=1, linestyle="solid",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y3_PHI_0_weights+y3_PHI_1_weights+y3_PHI_2_weights+y3_PHI_3_weights+y3_PHI_4_weights+y3_PHI_5_weights+y3_PHI_6_weights+y3_PHI_7_weights+y3_PHI_8_weights+y3_PHI_9_weights,\
             label="$bg\_dip\_0\_100$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#b7a39b", linewidth=1, linestyle="solid",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y3_PHI_0_weights+y3_PHI_1_weights+y3_PHI_2_weights+y3_PHI_3_weights+y3_PHI_4_weights+y3_PHI_5_weights+y3_PHI_6_weights+y3_PHI_7_weights+y3_PHI_8_weights,\
             label="$bg\_vbf\_1600\_inf$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#ad998c", linewidth=1, linestyle="solid",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y3_PHI_0_weights+y3_PHI_1_weights+y3_PHI_2_weights+y3_PHI_3_weights+y3_PHI_4_weights+y3_PHI_5_weights+y3_PHI_6_weights+y3_PHI_7_weights,\
             label="$bg\_vbf\_1200\_1600$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#9b8e82", linewidth=1, linestyle="solid",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y3_PHI_0_weights+y3_PHI_1_weights+y3_PHI_2_weights+y3_PHI_3_weights+y3_PHI_4_weights+y3_PHI_5_weights+y3_PHI_6_weights,\
             label="$bg\_vbf\_800\_1200$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#876656", linewidth=1, linestyle="solid",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y3_PHI_0_weights+y3_PHI_1_weights+y3_PHI_2_weights+y3_PHI_3_weights+y3_PHI_4_weights+y3_PHI_5_weights,\
             label="$bg\_vbf\_600\_800$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#afcec6", linewidth=1, linestyle="solid",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y3_PHI_0_weights+y3_PHI_1_weights+y3_PHI_2_weights+y3_PHI_3_weights+y3_PHI_4_weights,\
             label="$bg\_vbf\_400\_600$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#84c1a3", linewidth=1, linestyle="solid",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y3_PHI_0_weights+y3_PHI_1_weights+y3_PHI_2_weights+y3_PHI_3_weights,\
             label="$bg\_vbf\_200\_400$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#89a8a0", linewidth=1, linestyle="solid",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y3_PHI_0_weights+y3_PHI_1_weights+y3_PHI_2_weights,\
             label="$bg\_vbf\_100\_200$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#829e8c", linewidth=1, linestyle="solid",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y3_PHI_0_weights+y3_PHI_1_weights,\
             label="$bg\_vbf\_0\_100$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#adbcc6", linewidth=1, linestyle="solid",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y3_PHI_0_weights,\
             label="$signal$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#7a8e99", linewidth=1, linestyle="solid",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")


    # Axis
    plt.rc('text',usetex=False)
    plt.xlabel(r"\phi [ j_{1} ] ",\
               fontsize=16,color="black")
    plt.ylabel(r"$\mathrm{Events}$ $(\mathcal{L}_{\mathrm{int}} = 1000.0\ \mathrm{fb}^{-1})$ ",\
               fontsize=16,color="black")

    # Boundary of y-axis
    ymax=(y3_PHI_0_weights+y3_PHI_1_weights+y3_PHI_2_weights+y3_PHI_3_weights+y3_PHI_4_weights+y3_PHI_5_weights+y3_PHI_6_weights+y3_PHI_7_weights+y3_PHI_8_weights+y3_PHI_9_weights+y3_PHI_10_weights+y3_PHI_11_weights+y3_PHI_12_weights+y3_PHI_13_weights+y3_PHI_14_weights+y3_PHI_15_weights+y3_PHI_16_weights).max()*1.1
    ymin=0 # linear scale
    #ymin=min([x for x in (y3_PHI_0_weights+y3_PHI_1_weights+y3_PHI_2_weights+y3_PHI_3_weights+y3_PHI_4_weights+y3_PHI_5_weights+y3_PHI_6_weights+y3_PHI_7_weights+y3_PHI_8_weights+y3_PHI_9_weights+y3_PHI_10_weights+y3_PHI_11_weights+y3_PHI_12_weights+y3_PHI_13_weights+y3_PHI_14_weights+y3_PHI_15_weights+y3_PHI_16_weights) if x])/100. # log scale
    plt.gca().set_ylim(ymin,ymax)

    # Log/Linear scale for X-axis
    plt.gca().set_xscale("linear")
    #plt.gca().set_xscale("log",nonposx="clip")

    # Log/Linear scale for Y-axis
    plt.gca().set_yscale("linear")
    #plt.gca().set_yscale("log",nonposy="clip")

    # Legend
    plt.legend(bbox_to_anchor=(1.05,1), loc=2, borderaxespad=0.)

    # Saving the image
    plt.savefig('../../HTML/MadAnalysis5job_0/selection_2.png')
    plt.savefig('../../PDF/MadAnalysis5job_0/selection_2.png')
    plt.savefig('../../DVI/MadAnalysis5job_0/selection_2.eps')

# Running!
if __name__ == '__main__':
    selection_2()
