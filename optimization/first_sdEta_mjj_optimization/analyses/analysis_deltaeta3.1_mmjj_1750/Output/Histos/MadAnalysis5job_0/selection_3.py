def selection_3():

    # Library import
    import numpy
    import matplotlib
    import matplotlib.pyplot   as plt
    import matplotlib.gridspec as gridspec

    # Library version
    matplotlib_version = matplotlib.__version__
    numpy_version      = numpy.__version__

    # Histo binning
    xBinning = numpy.linspace(0.0,500.0,101,endpoint=True)

    # Creating data sequence: middle of each bin
    xData = numpy.array([2.5,7.5,12.5,17.5,22.5,27.5,32.5,37.5,42.5,47.5,52.5,57.5,62.5,67.5,72.5,77.5,82.5,87.5,92.5,97.5,102.5,107.5,112.5,117.5,122.5,127.5,132.5,137.5,142.5,147.5,152.5,157.5,162.5,167.5,172.5,177.5,182.5,187.5,192.5,197.5,202.5,207.5,212.5,217.5,222.5,227.5,232.5,237.5,242.5,247.5,252.5,257.5,262.5,267.5,272.5,277.5,282.5,287.5,292.5,297.5,302.5,307.5,312.5,317.5,322.5,327.5,332.5,337.5,342.5,347.5,352.5,357.5,362.5,367.5,372.5,377.5,382.5,387.5,392.5,397.5,402.5,407.5,412.5,417.5,422.5,427.5,432.5,437.5,442.5,447.5,452.5,457.5,462.5,467.5,472.5,477.5,482.5,487.5,492.5,497.5])

    # Creating weights for histo: y4_PT_0
    y4_PT_0_weights = numpy.array([0.0,0.0,0.0,0.0,143.166039634,135.317646232,126.650493519,121.352737973,117.827740937,112.403065497,109.144188237,105.684671146,103.477993001,100.579355438,97.7708377995,94.9131602021,92.256082436,89.0626851208,86.634927162,83.6748896506,80.8950119878,78.9175736503,76.0516960598,73.0425385897,71.1756601593,68.5718223485,66.2177043277,64.612825677,61.5136282826,61.0345886854,57.3540317798,56.3959925853,53.3581951393,51.9457563268,50.3203976933,49.5957183026,47.1679603437,45.2642019443,43.4668834554,42.7831640302,40.8876056239,40.2038861987,38.2796838165,36.8344730315,35.6103420607,34.7137388145,34.4107750693,31.5121655063,31.1109458436,29.3422993306,29.5347231688,28.0854163873,27.0496132581,26.6238296161,25.6084944697,24.1100597295,24.3311395437,22.9514367037,22.8982127484,21.5307898981,20.4949827689,20.3762548687,19.3158877602,18.9392320769,18.0671928101,16.8921897979,16.8430618393,16.2862663074,15.2013352195,14.9802554054,14.1737200835,13.5309486239,13.3589967685,13.0191890542,12.4255455533,12.1799017598,11.5739742692,11.455246369,10.7633469508,10.2352113948,10.0182235772,9.58015594552,9.46961603845,8.83912856853,8.4624728852,8.33555699191,8.11856917434,8.06534521909,7.41848176294,7.61499759772,6.91490618632,6.76752231023,6.53006250987,6.29670270607,5.83407109502,5.7685631501,5.57204731532,5.41237944956,5.09303971804,5.00297179377])

    # Creating weights for histo: y4_PT_1
    y4_PT_1_weights = numpy.array([0.0,0.0,0.0,0.0,952.118452218,936.411952818,823.905253345,658.331487307,417.63602334,146.333454483,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])

    # Creating weights for histo: y4_PT_2
    y4_PT_2_weights = numpy.array([0.0,0.0,0.0,0.0,168.305808259,255.263875306,372.823081043,535.104030574,741.517609524,962.998087213,1045.5786423,960.261806505,852.447718647,740.011043613,639.607888177,528.048046073,414.747347637,298.816646265,181.464128479,59.9859506051,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])

    # Creating weights for histo: y4_PT_3
    y4_PT_3_weights = numpy.array([0.0,0.0,0.0,0.0,15.1749321573,19.4490310268,25.5169067935,31.3900434992,38.7392279433,47.6714396543,58.7101604664,70.8710024024,86.4769402231,104.439856475,131.040192522,160.497608772,206.307621693,259.877662212,326.833367437,398.438515991,412.749714294,371.517359173,332.455470117,300.619421963,269.047928054,239.784255537,214.923509893,191.471296217,171.535232691,153.634676814,138.312062288,120.738136651,105.005771802,92.6795022128,77.9738288324,64.4261084007,52.3744275907,38.0840296214,22.5073097693,7.52486194948,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])

    # Creating weights for histo: y4_PT_4
    y4_PT_4_weights = numpy.array([0.0,0.0,0.0,0.0,0.895036050982,0.998708115439,1.22364236845,1.47522916274,1.76646348107,2.03984633265,2.15433084806,2.33683540013,2.6566274156,2.87961723119,3.12931650624,3.56236769282,3.59011731207,4.00658566609,4.44178290873,4.8514214814,5.26272751639,5.50454161869,6.2103431435,6.75701024192,7.34316733728,8.03011371129,8.68612384937,9.74303040794,11.1257494829,12.2350247798,13.5997464851,15.4135125853,17.7711279328,20.6467588869,23.959866216,28.2289264838,33.8845137334,40.6718108629,49.3141157266,58.3449072432,60.1439627984,55.6988529817,50.9612157617,46.664013059,42.8872109149,39.4112654691,35.8620358562,33.295141963,29.8885124446,27.3445902499,24.7521272652,22.431821387,20.1801660545,17.6427173013,15.3533155923,12.7590729123,10.2368517776,7.38941135827,4.5325353469,1.6460787144,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])

    # Creating weights for histo: y4_PT_5
    y4_PT_5_weights = numpy.array([0.0,0.0,0.0,0.0,0.136886458566,0.140912014279,0.197641566209,0.218539095167,0.235963285003,0.264441128935,0.274762841988,0.323927122665,0.318908081217,0.343842048579,0.382664931334,0.39197011295,0.40306529732,0.432064070103,0.438360027394,0.472382442764,0.465578359789,0.501870936679,0.536944412026,0.557863986437,0.584275719322,0.603446461163,0.616574908455,0.691430223754,0.681316522152,0.708117951427,0.762018883705,0.819764366924,0.881762101928,0.895335859367,0.986862098182,1.00553351652,1.05695943661,1.17043310407,1.24297224647,1.29866042082,1.40859721344,1.51368680712,1.6211313833,1.77717598059,1.92813171916,2.04962897124,2.27121818085,2.50441626189,2.71058165645,3.12972253002,3.37258700202,3.87567063866,4.37941923977,5.00900296593,5.68959930995,6.6565544842,7.96714265531,9.441583355,11.266810821,13.2609400645,13.7990051537,12.9442697368,11.9945388229,11.1258239482,10.3847966567,9.67608535855,8.99723344602,8.33568981465,7.80663895507,7.07732656125,6.47211286296,5.89066104213,5.38134706443,4.75913316118,4.23713604634,3.51822702576,2.85283804325,2.10157221929,1.25053371678,0.408132150595,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])

    # Creating weights for histo: y4_PT_6
    y4_PT_6_weights = numpy.array([0.0,0.0,0.0,0.0,0.0437911781739,0.0489514269239,0.0552475645862,0.0572632783195,0.0641026037436,0.0655706512175,0.0847497366844,0.0807320745995,0.0892878941444,0.0921723964014,0.0890372282421,0.099326796119,0.103092312798,0.108194501027,0.101057695407,0.110503326422,0.105907468321,0.106223962138,0.12516150864,0.126562838498,0.119386746058,0.12654214544,0.13254213246,0.123969008721,0.132545931186,0.130838404057,0.134011839377,0.149440463114,0.145385823435,0.144822612391,0.155743648412,0.156581667259,0.173458005292,0.17199069757,0.17776326089,0.184114330122,0.179828867884,0.184974541524,0.20093288754,0.225586116446,0.217598596238,0.238517777908,0.226769019585,0.241916137767,0.252240673912,0.279178336396,0.281762269493,0.298963498526,0.300047334902,0.31954719275,0.350724432867,0.362468192867,0.408745067096,0.429087042416,0.444566449116,0.486978619943,0.51610764723,0.529406085639,0.592311081177,0.653640205416,0.679052679597,0.782207771333,0.833433685172,0.935902407183,0.979665324839,1.08603763721,1.17703110913,1.37654817168,1.5347061101,1.71518456005,1.93025440468,2.18602759344,2.60373545355,3.12003623598,3.62216777216,4.2794812452,4.38187389274,4.16592734224,3.96655023274,3.74163269199,3.56436616445,3.41773036038,3.18260624391,3.02722137512,2.85248699805,2.76289405625,2.62589801806,2.53674492869,2.38961928896,2.33083800993,2.13949520494,2.0263841534,1.87355442738,1.85273741143,1.74868232164,1.64396045555])

    # Creating weights for histo: y4_PT_7
    y4_PT_7_weights = numpy.array([0.0,0.0,0.0,0.0,0.00444677010568,0.00531219296237,0.00520460288606,0.00591905933076,0.00678095759823,0.00664891751783,0.0069322886229,0.007578734326,0.00716517973151,0.00716836485375,0.00766287603533,0.00708041357059,0.00792546421783,0.00729963379929,0.00771017510051,0.00807470395829,0.00876673043694,0.00777299744562,0.00697413107078,0.00811820602249,0.00770764376652,0.00813897218126,0.00809544078042,0.00870117978317,0.00844310944511,0.00861477915162,0.00855127787256,0.00850410453589,0.00917373038514,0.00887326020282,0.00878773547988,0.0100834306318,0.00893703389365,0.00986876596611,0.00960914916739,0.00976106273415,0.00982632840329,0.0100388682572,0.0101251431602,0.0101880577063,0.00984879189694,0.0102771698827,0.00974099227312,0.0114914390611,0.0108205768815,0.0121149099746,0.0114485698304,0.0113133697735,0.0122198597522,0.012268370002,0.0124565227161,0.0137320761609,0.013947889147,0.0128485106803,0.0145733256162,0.0147005335309,0.0148351426638,0.0158084405814,0.0158036419433,0.016518693503,0.0162631922174,0.0168209699849,0.0172297427051,0.0188096890617,0.0192194131276,0.0200840564675,0.0201892493202,0.0207990786905,0.0217610191328,0.0231239245548,0.0233796814883,0.0254349863835,0.0264130619845,0.0267720043055,0.02675711805,0.0298326804611,0.028433938223,0.0315295208037,0.034831260421,0.0340726900334,0.0360899201451,0.0394737437151,0.0405066327551,0.0413982113327,0.0451950823922,0.0446528153319,0.0497081072313,0.0509615366494,0.0572468305547,0.058080410571,0.0618866316406,0.0651403597312,0.071445351103,0.0740825484937,0.0795625093879,0.0853638323516])

    # Creating weights for histo: y4_PT_8
    y4_PT_8_weights = numpy.array([0.0,0.0,0.0,0.0,0.000708531831951,0.000678655359445,0.000936125264437,0.00099244185008,0.00110294424393,0.00130218225439,0.00087971111654,0.00116123212168,0.000930613219868,0.000652588269718,0.000879155887826,0.000991042121313,0.000936865816883,0.00079327274204,0.00124737097858,0.00107728329235,0.000960440688502,0.00119399893163,0.00104543567624,0.00113391751218,0.00116371988489,0.000708963363014,0.000964841978649,0.000905529177502,0.000966284771424,0.000906100592344,0.00107681745858,0.000963260787061,0.00104869057279,0.00101596697534,0.00105043718957,0.00105028720802,0.000849940819089,0.00110483802082,0.00113520794747,0.00118740508947,0.00113273785535,0.000965716178018,0.00110560233272,0.00110672511537,0.00155946208376,0.00144158921063,0.00124731662883,0.00107698303227,0.00113644536947,0.001220580859,0.00113455099859,0.00107812764391,0.00116183546329,0.00101872960573,0.0013362748418,0.00144115723408,0.00119100420109,0.00101888909105,0.00112993765533,0.00135979580916,0.00133091396675,0.00116235965622,0.00138955630584,0.00136054482592,0.00201052787163,0.00139414173175,0.00144669556254,0.00144918674117,0.00169921370056,0.00136147679045,0.00193097973846,0.00138786210835,0.00254884876519,0.00136277955095,0.00192733117748,0.00200902805616,0.00173005941025,0.0022107636306,0.00170235291827,0.00187191670856,0.00254878342669,0.00241248584035,0.00266089685995,0.00200947948577,0.00246619408356,0.00261144155881,0.002240449582,0.00294892379727,0.00249371940971,0.00283955012593,0.00235645362566,0.0025471113552,0.00286040498568,0.00345859821551,0.00283756621161,0.0037781316723,0.00325620034632,0.00430785015896,0.00343249845653,0.00371750497341])

    # Creating weights for histo: y4_PT_9
    y4_PT_9_weights = numpy.array([0.0,0.0,0.0,0.0,222102.645775,180005.517657,139293.627699,97042.4218765,57266.1492646,18981.0427534,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])

    # Creating weights for histo: y4_PT_10
    y4_PT_10_weights = numpy.array([0.0,0.0,0.0,0.0,22028.4037575,29122.9892584,40611.7188362,59642.3455428,84313.4150085,108142.434965,115350.432627,99346.4900673,82051.8666409,64410.8813375,50064.681665,38539.6652747,28516.4442794,19015.0054088,10817.4293178,3505.19604645,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])

    # Creating weights for histo: y4_PT_11
    y4_PT_11_weights = numpy.array([0.0,0.0,0.0,0.0,2371.78826378,2400.12642334,2373.63372336,2359.55781949,2480.49747522,2726.42888258,3025.0490639,3405.48654107,3952.81458008,4697.97603974,5790.94688235,7292.37406606,9388.11377521,12453.8013729,15806.0904187,18943.5369236,19376.2343734,16605.3477048,14432.6081831,12428.138611,10794.2018197,9480.36754268,8227.77578122,7240.66815399,6323.8286192,5547.57521925,4824.42248845,4265.56676293,3665.00242136,3201.24453822,2677.44370741,2202.41480379,1727.53498165,1203.05867344,697.664793836,238.402255036,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])

    # Creating weights for histo: y4_PT_12
    y4_PT_12_weights = numpy.array([0.0,0.0,0.0,0.0,147.178041682,129.898113733,114.583732288,106.640025201,99.0505635235,94.6517342333,93.9817148969,91.7936108676,89.6919137876,90.2193578105,92.0165531078,92.7937155224,93.3705184571,96.6419794289,107.965059996,109.353726622,116.498573379,123.808231965,133.195889199,147.009498118,156.733588464,173.730173946,196.857959567,215.576682483,245.565703093,278.019322276,320.939800715,374.912212713,441.261746951,528.178828132,625.204676012,781.827466607,978.245927959,1230.46765915,1507.32883593,1776.66075889,1829.62675691,1656.32927173,1530.9249349,1391.87822573,1274.93530673,1176.9792184,1063.50988954,984.77838566,874.517193712,799.607831598,731.596406266,662.815551287,592.8120726,521.559424881,454.993757855,378.307321029,302.000867033,216.124939578,128.290698258,42.8094882121,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])

    # Creating weights for histo: y4_PT_13
    y4_PT_13_weights = numpy.array([0.0,0.0,0.0,0.0,21.7350239675,18.0562162007,15.3847048656,14.7799252847,12.7138792491,12.2299864057,11.3725164661,10.9491671185,9.92053452058,9.7995506902,9.40649432957,9.48719067188,9.88005891499,9.68871306859,9.43602270991,9.64953001232,9.81018843182,10.0630365665,10.1320574867,10.4849537937,10.8882595243,11.1305852152,11.0998431735,12.6221932034,12.3195728173,12.6320906116,13.1575392191,14.6292249565,14.5989805159,15.0628176057,16.4845429741,17.5425522447,19.2871540069,20.4357388231,22.0691874117,23.4013081636,26.4352491156,29.3902292609,31.074578806,34.3998166838,37.7974069822,43.5129387267,46.0447879835,52.1748214844,59.313280122,68.1631044061,77.8233025016,91.6256053744,105.075278946,121.537442005,146.711933655,174.749877181,211.813395289,260.841004809,314.241860908,363.792437098,383.019199317,357.834937693,332.997055014,313.579505233,291.684690614,269.329109468,251.305753148,232.050409205,215.228577609,198.995675176,182.384656554,167.572162667,150.443032021,132.879531981,116.910540206,99.2793178643,80.5946981648,57.1354862188,34.4899613796,12.4109918575,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])

    # Creating weights for histo: y4_PT_14
    y4_PT_14_weights = numpy.array([0.0,0.0,0.0,0.0,5.55358917276,4.62313425752,4.1023135817,3.76280116775,3.17417327112,2.89716864901,2.8773063708,2.65373733676,2.41345551815,2.40185787138,2.15024580133,2.1727789548,2.14192153496,2.23791722405,2.11082249748,1.87585972964,2.13285087014,1.85305687241,1.99165382986,1.99459133096,2.09058201841,1.9293880404,2.02007699044,2.09075284362,2.09085672381,2.0683027943,2.07658820179,2.12472397615,2.05405966521,2.28315666465,2.45297616159,2.4333135642,2.48401056251,2.54058948835,2.68201044817,2.73018931357,2.82911750212,3.02726512851,3.0527053885,3.23369277599,3.55321017592,3.66944634408,3.67792796971,3.91829173825,4.3427577612,4.41604331575,4.72711063885,5.00494014666,5.55074208591,5.86486040884,6.23241547406,6.64565474102,7.08127057166,7.71747136589,8.252639051,9.14702060634,9.85375605362,10.8698313348,11.7574991516,13.1277328001,14.1174148167,15.4841280809,16.8247097046,19.4837041487,21.3914447105,24.1840367815,27.8384805169,31.5313483825,35.7041581431,41.2386679865,48.243232652,57.7246474565,67.3989716324,81.2855992804,97.1624175865,112.290528999,118.30746232,112.436230592,107.240912673,100.958430792,95.6830866477,90.3666136408,86.9743481304,82.7170299067,77.7735637515,74.4011509008,70.7855429691,67.5979599189,63.8289170903,60.4232625769,57.1066372389,55.2310225895,52.4444170958,49.2806495423,46.6276647599,44.7773276249])

    # Creating weights for histo: y4_PT_15
    y4_PT_15_weights = numpy.array([0.0,0.0,0.0,0.0,0.373193839511,0.315278776696,0.298628711628,0.269703970826,0.260459974188,0.21480824333,0.191862027517,0.207153675285,0.182751320259,0.187317308679,0.18278097951,0.138634307903,0.155306587867,0.135655266624,0.127958868401,0.143286319965,0.129416071092,0.123434001173,0.13104945682,0.131015543654,0.118844970706,0.123459052014,0.0867862397206,0.123348804681,0.128073724143,0.129361833658,0.138641752256,0.109669379407,0.0958883091646,0.114318531892,0.131063163884,0.165922354375,0.140229290219,0.108117928835,0.14170279959,0.118738740961,0.121848590168,0.152341135488,0.146291357399,0.130972649997,0.114281617351,0.121951511312,0.169115745774,0.156821809251,0.139975591372,0.158450232077,0.134098805884,0.142946124818,0.156903578977,0.166198977105,0.155448266915,0.20099790378,0.161487410213,0.185828792437,0.178217590706,0.173594765236,0.200968480858,0.235936618874,0.243854338914,0.205541440974,0.264955536659,0.22088579004,0.301494905958,0.210228666011,0.277179992547,0.344181657094,0.274159711913,0.316869977753,0.347260074586,0.329013018408,0.35791353552,0.376239052822,0.449510281138,0.408335442784,0.428045728035,0.486109559759,0.540827922574,0.531556866302,0.556139540117,0.554521397589,0.656559735471,0.687016004337,0.685662077283,0.747958083155,0.821095785761,0.81340269614,0.778198702093,0.936908304905,1.05206063986,1.04951242578,1.20785583729,1.31611682769,1.30847277628,1.50826977583,1.48047397717,1.76464622661])

    # Creating weights for histo: y4_PT_16
    y4_PT_16_weights = numpy.array([0.0,0.0,0.0,0.0,0.040268796613,0.0314185755065,0.0301555863433,0.0225661553251,0.0243762904914,0.0214872915043,0.0173311324292,0.017519051272,0.015710807079,0.0144499938831,0.0166126318933,0.0144445867008,0.0124558026973,0.0119190281629,0.0149843998869,0.0108340331211,0.0130001488276,0.010474551777,0.0124578284651,0.0119158893783,0.0122763104321,0.0119154272259,0.0124624384346,0.0133582899299,0.0108323270087,0.0101108263339,0.00704458807425,0.0128213266833,0.00938906762396,0.0090303334261,0.0106568015511,0.0119131010592,0.0119085719663,0.00866691993583,0.0115548328649,0.0120955819095,0.00939044637843,0.0122763450936,0.0102907923052,0.0128162237512,0.0140781961792,0.0106501735163,0.0119181308171,0.0108316684416,0.0113738077945,0.012275235928,0.0135409556412,0.0193161691475,0.0144424916102,0.0153450558682,0.0124622035072,0.0178741267639,0.0137205788495,0.0160689520327,0.0184205025131,0.0169800468525,0.0160677003701,0.0166133559319,0.0155297049832,0.0187814742985,0.0182401668199,0.0178793914492,0.0180531414716,0.019140774633,0.0207644582902,0.0204069680524,0.0216684167077,0.0220312987228,0.0209422752531,0.0220215935237,0.0236504455845,0.0214828471393,0.0249168084597,0.0227529958124,0.0240148257434,0.0303335303982,0.0287096965415,0.0283491984622,0.0305207290536,0.031780564027,0.0357574696156,0.0325003046717,0.0350309892493,0.0377326740429,0.0362882169133,0.0359301836465,0.0422488497885,0.0399075475362,0.039540791144,0.046404099964,0.0431450787082,0.0460415029429,0.0451442726931,0.0509097386364,0.0525520739916,0.0547025073288])

    # Creating a new Canvas
    fig   = plt.figure(figsize=(12,6),dpi=80)
    frame = gridspec.GridSpec(1,1,right=0.7)
    pad   = fig.add_subplot(frame[0])

    # Creating a new Stack
    pad.hist(x=xData, bins=xBinning, weights=y4_PT_0_weights+y4_PT_1_weights+y4_PT_2_weights+y4_PT_3_weights+y4_PT_4_weights+y4_PT_5_weights+y4_PT_6_weights+y4_PT_7_weights+y4_PT_8_weights+y4_PT_9_weights+y4_PT_10_weights+y4_PT_11_weights+y4_PT_12_weights+y4_PT_13_weights+y4_PT_14_weights+y4_PT_15_weights+y4_PT_16_weights,\
             label="$bg\_dip\_1600\_inf$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#e5e5e5", linewidth=4, linestyle="dashdot",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y4_PT_0_weights+y4_PT_1_weights+y4_PT_2_weights+y4_PT_3_weights+y4_PT_4_weights+y4_PT_5_weights+y4_PT_6_weights+y4_PT_7_weights+y4_PT_8_weights+y4_PT_9_weights+y4_PT_10_weights+y4_PT_11_weights+y4_PT_12_weights+y4_PT_13_weights+y4_PT_14_weights+y4_PT_15_weights,\
             label="$bg\_dip\_1200\_1600$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#f2f2f2", linewidth=4, linestyle="dashdot",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y4_PT_0_weights+y4_PT_1_weights+y4_PT_2_weights+y4_PT_3_weights+y4_PT_4_weights+y4_PT_5_weights+y4_PT_6_weights+y4_PT_7_weights+y4_PT_8_weights+y4_PT_9_weights+y4_PT_10_weights+y4_PT_11_weights+y4_PT_12_weights+y4_PT_13_weights+y4_PT_14_weights,\
             label="$bg\_dip\_800\_1200$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#ccc6aa", linewidth=4, linestyle="dashdot",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y4_PT_0_weights+y4_PT_1_weights+y4_PT_2_weights+y4_PT_3_weights+y4_PT_4_weights+y4_PT_5_weights+y4_PT_6_weights+y4_PT_7_weights+y4_PT_8_weights+y4_PT_9_weights+y4_PT_10_weights+y4_PT_11_weights+y4_PT_12_weights+y4_PT_13_weights,\
             label="$bg\_dip\_600\_800$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#ccc6aa", linewidth=4, linestyle="dashdot",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y4_PT_0_weights+y4_PT_1_weights+y4_PT_2_weights+y4_PT_3_weights+y4_PT_4_weights+y4_PT_5_weights+y4_PT_6_weights+y4_PT_7_weights+y4_PT_8_weights+y4_PT_9_weights+y4_PT_10_weights+y4_PT_11_weights+y4_PT_12_weights,\
             label="$bg\_dip\_400\_600$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#c1bfa8", linewidth=4, linestyle="dashdot",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y4_PT_0_weights+y4_PT_1_weights+y4_PT_2_weights+y4_PT_3_weights+y4_PT_4_weights+y4_PT_5_weights+y4_PT_6_weights+y4_PT_7_weights+y4_PT_8_weights+y4_PT_9_weights+y4_PT_10_weights+y4_PT_11_weights,\
             label="$bg\_dip\_200\_400$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#bab5a3", linewidth=4, linestyle="dashdot",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y4_PT_0_weights+y4_PT_1_weights+y4_PT_2_weights+y4_PT_3_weights+y4_PT_4_weights+y4_PT_5_weights+y4_PT_6_weights+y4_PT_7_weights+y4_PT_8_weights+y4_PT_9_weights+y4_PT_10_weights,\
             label="$bg\_dip\_100\_200$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#b2a596", linewidth=4, linestyle="dashdot",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y4_PT_0_weights+y4_PT_1_weights+y4_PT_2_weights+y4_PT_3_weights+y4_PT_4_weights+y4_PT_5_weights+y4_PT_6_weights+y4_PT_7_weights+y4_PT_8_weights+y4_PT_9_weights,\
             label="$bg\_dip\_0\_100$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#b7a39b", linewidth=4, linestyle="dashdot",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y4_PT_0_weights+y4_PT_1_weights+y4_PT_2_weights+y4_PT_3_weights+y4_PT_4_weights+y4_PT_5_weights+y4_PT_6_weights+y4_PT_7_weights+y4_PT_8_weights,\
             label="$bg\_vbf\_1600\_inf$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#ad998c", linewidth=4, linestyle="dashdot",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y4_PT_0_weights+y4_PT_1_weights+y4_PT_2_weights+y4_PT_3_weights+y4_PT_4_weights+y4_PT_5_weights+y4_PT_6_weights+y4_PT_7_weights,\
             label="$bg\_vbf\_1200\_1600$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#9b8e82", linewidth=4, linestyle="dashdot",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y4_PT_0_weights+y4_PT_1_weights+y4_PT_2_weights+y4_PT_3_weights+y4_PT_4_weights+y4_PT_5_weights+y4_PT_6_weights,\
             label="$bg\_vbf\_800\_1200$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#876656", linewidth=4, linestyle="dashdot",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y4_PT_0_weights+y4_PT_1_weights+y4_PT_2_weights+y4_PT_3_weights+y4_PT_4_weights+y4_PT_5_weights,\
             label="$bg\_vbf\_600\_800$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#afcec6", linewidth=4, linestyle="dashdot",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y4_PT_0_weights+y4_PT_1_weights+y4_PT_2_weights+y4_PT_3_weights+y4_PT_4_weights,\
             label="$bg\_vbf\_400\_600$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#84c1a3", linewidth=4, linestyle="dashdot",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y4_PT_0_weights+y4_PT_1_weights+y4_PT_2_weights+y4_PT_3_weights,\
             label="$bg\_vbf\_200\_400$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#89a8a0", linewidth=4, linestyle="dashdot",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y4_PT_0_weights+y4_PT_1_weights+y4_PT_2_weights,\
             label="$bg\_vbf\_100\_200$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#829e8c", linewidth=4, linestyle="dashdot",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y4_PT_0_weights+y4_PT_1_weights,\
             label="$bg\_vbf\_0\_100$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#adbcc6", linewidth=4, linestyle="dashdot",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")

    pad.hist(x=xData, bins=xBinning, weights=y4_PT_0_weights,\
             label="$signal$", histtype="step", rwidth=1.0,\
             color=None, edgecolor="#7a8e99", linewidth=3, linestyle="dashed",\
             bottom=None, cumulative=False, normed=False, align="mid", orientation="vertical")


    # Axis
    plt.rc('text',usetex=False)
    plt.xlabel(r"p_{T} [ j_{2} ]   ( GeV ) ",\
               fontsize=16,color="black")
    plt.ylabel(r"$\mathrm{Events}$ $(\mathcal{L}_{\mathrm{int}} = 40.0\ \mathrm{fb}^{-1})$ ",\
               fontsize=16,color="black")

    # Boundary of y-axis
    ymax=(y4_PT_0_weights+y4_PT_1_weights+y4_PT_2_weights+y4_PT_3_weights+y4_PT_4_weights+y4_PT_5_weights+y4_PT_6_weights+y4_PT_7_weights+y4_PT_8_weights+y4_PT_9_weights+y4_PT_10_weights+y4_PT_11_weights+y4_PT_12_weights+y4_PT_13_weights+y4_PT_14_weights+y4_PT_15_weights+y4_PT_16_weights).max()*1.1
    #ymin=0 # linear scale
    ymin=min([x for x in (y4_PT_0_weights+y4_PT_1_weights+y4_PT_2_weights+y4_PT_3_weights+y4_PT_4_weights+y4_PT_5_weights+y4_PT_6_weights+y4_PT_7_weights+y4_PT_8_weights+y4_PT_9_weights+y4_PT_10_weights+y4_PT_11_weights+y4_PT_12_weights+y4_PT_13_weights+y4_PT_14_weights+y4_PT_15_weights+y4_PT_16_weights) if x])/100. # log scale
    plt.gca().set_ylim(ymin,ymax)

    # Log/Linear scale for X-axis
    plt.gca().set_xscale("linear")
    #plt.gca().set_xscale("log",nonposx="clip")

    # Log/Linear scale for Y-axis
    #plt.gca().set_yscale("linear")
    plt.gca().set_yscale("log",nonposy="clip")

    # Legend
    plt.legend(bbox_to_anchor=(1.05,1), loc=2, borderaxespad=0.)

    # Saving the image
    plt.savefig('../../HTML/MadAnalysis5job_0/selection_3.png')
    plt.savefig('../../PDF/MadAnalysis5job_0/selection_3.png')
    plt.savefig('../../DVI/MadAnalysis5job_0/selection_3.eps')

# Running!
if __name__ == '__main__':
    selection_3()
